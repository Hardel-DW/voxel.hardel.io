---
import Navigation from "@/components/layouts/compound/navbar/Navigation.astro";
import NavigationList from "@/components/layouts/compound/navbar/NavigationList.astro";
import NavigationDropdown from "@/components/layouts/compound/navbar/NavigationDropdown.astro";
import ListItem from "@/components/layouts/compound/navbar/ListItem.astro";
import HeroCard from "@/components/layouts/compound/navbar/HeroCard.astro";
import Button from "@/components/ui/button.astro";
import { getTranslations } from "@/lib/i18n";
import { cn } from "@/lib/utils";
import Internalization from "@/components/layouts/compound/internalization.astro";

const { translate, lang } = await getTranslations(Astro.url);
const links = [
    { name: translate["navbar.item.blog"], href: `/${lang}/blog` },
    { name: translate["navbar.item.data_pack"], href: `/${lang}/datapacks/neoenchant` },
    { name: translate["navbar.item.resources"], href: `/${lang}/soon` },
    { name: translate["navbar.item.contact"], href: `/${lang}/contact` }
];

interface Props {
    transparent?: boolean;
    full?: boolean;
    className?: string;
}

const { transparent = true, full = true, className }: Props = Astro.props;
---

<header id="header" aria-expanded="false" class={cn("mt-8 fixed left-0 right-0 z-50 group", className)}>
    <nav id="navbar"
         class={cn("flex group-aria-expanded:border-t group-aria-expanded:border-l group-aria-expanded:bg-header-translucent transition-colors duration-150 ease-linear border-zinc-800 justify-between items-center max-w-full h-14 rounded-3xl px-2",
             {"bg-header-translucent border-t border-l": !transparent},
             {"mx-auto w-10/12 md:w-3/4": full}
         )}>
        <!-- Left Part -->
        <div class="flex items-center gap-4 pl-2">
            <a href=`/${lang}` class="flex items-center gap-x-4">
                <img src="/icons/logo.svg" alt="Voxel" class="w-6 h-6 brightness-90 mx-2"/>
                <span class="text-lg text-white font-bold">
                    {translate["generic.website"]}
                </span>
            </a>

            <!-- Desktop -->
            <div class="hidden md:block">
                <Navigation>
                    <NavigationList>
                        <li>
                            <a
                                href={`/${lang}/blog`}
                                class="px-4 py-2 rounded-3xl cursor-pointer text-[16px] tracking-wide transition text-zinc-400 hover:text-white inline-flex h-10 w-max items-center justify-center bg-transparent hover:bg-zinc-900 focus:bg-zinc-700 focus:text-white focus:outline-hidden disabled:pointer-events-none disabled:opacity-50"
                            >
                                {translate["navbar.item.blog"]}
                            </a>
                        </li>
                
                        <NavigationDropdown label={translate["navbar.item.data_pack"]}>
                            <div class="p-6 space-y-6 md:w-[400px] lg:w-[500px]">
                                <HeroCard
                                    title={translate["navbar.datapack.modrinth.title"]}
                                    description={translate["navbar.datapack.modrinth.description"]}
                                    image="/images/background/modrinth.webp"
                                    href="https://modrinth.com/user/Hardel-DW"
                                />
                                <ul class="grid gap-3 mt-3">
                                    <ListItem
                                        href={`/${lang}/datapacks/neoenchant`}
                                        title={translate["navbar.datapack.neoenchant.title"]}
                                        image="/images/features/title/ne.png"
                                    >
                                        {translate["navbar.datapack.neoenchant.description"]}
                                    </ListItem>
                                    <ListItem
                                        href={`/${lang}/datapacks/yggdrasil`}
                                        title={translate["navbar.datapack.yggdrasil.title"]}
                                        image="/images/features/title/yg.webp"
                                    >
                                        {translate["navbar.datapack.yggdrasil.description"]}
                                    </ListItem>
                                </ul>
                            </div>
                        </NavigationDropdown>
                
                        <NavigationDropdown label={translate["navbar.item.resources"]}>
                            <div class="p-6 md:w-[400px] lg:w-[500px]">
                                <HeroCard
                                    href={`/${lang}/tools/enchant`}
                                    title={translate["navbar.resources.tool.enchant.title"]}
                                    description={translate["navbar.resources.tool.enchant.description"]}
                                    image="/images/background/tools/enchant-configurator.webp"
                                />
                                <ul class="grid gap-3 mt-3 lg:grid-cols-[.75fr_1fr]">
                                    <ListItem
                                        href={`/${lang}/tools/harmonization`}
                                        title={translate["navbar.resources.harmonization.title"]}
                                    >
                                        {translate["navbar.resources.harmonization.description"]}
                                    </ListItem>
                                    <ListItem
                                        href={`/${lang}/resources/asset`}
                                        title={translate["navbar.resources.asset.title"]}
                                    >
                                        {translate["navbar.resources.asset.description"]}
                                    </ListItem>
                                    <ListItem
                                        href={`/${lang}/tools/converter`}
                                        title={translate["navbar.resources.converter.title"]} 
                                    >
                                        {translate["navbar.resources.converter.description"]}
                                    </ListItem>
                                    <ListItem
                                        href={`/${lang}/tools/migration`}
                                        title={translate["navbar.resources.migration.title"]}
                                    >
                                        {translate["navbar.resources.migration.description"]}
                                    </ListItem>
                                </ul>
                            </div>
                        </NavigationDropdown>
                
                        <li>
                            <a
                                href={`/${lang}/contact`}
                                class="px-4 py-2 rounded-3xl cursor-pointer text-[16px] tracking-wide transition text-zinc-400 hover:text-white inline-flex h-10 w-max items-center justify-center bg-transparent hover:bg-zinc-900 focus:bg-zinc-700 focus:text-white focus:outline-hidden disabled:pointer-events-none disabled:opacity-50"
                            >
                                {translate["navbar.item.contact"]}
                            </a>
                        </li>
                    </NavigationList>
                </Navigation>
            </div>
        </div>

        <!-- Right Part -->
        <div>
            <!-- Desktop -->
            <div class="hidden lg:flex items-center gap-2 px-4">
                <Internalization/>
                <a href="https://x.com/VoxelioStudio" target="_blank" rel="noopener noreferrer">
                    <img src="/icons/company/x.svg" alt="x" class="w-6 h-6 invert mx-1 cursor-pointer opacity-70 hover:opacity-100 transition-opacity duration-150 ease-linear"/>
                </a>
                <a href="https://bsky.app/profile/voxelstudio.bsky.social" target="_blank" rel="noopener noreferrer">
                    <img src="/icons/company/bluesky.svg" alt="Bluesky" class="w-6 h-6 invert mx-1 cursor-pointer opacity-70 hover:opacity-100 transition-opacity duration-150 ease-linear"/>
                </a>
                <a href="https://discord.gg/TAmVFvkHep" target="_blank" rel="noopener noreferrer">
                    <img src="/icons/company/discord.svg" alt="Discord" class="w-6 h-6 invert mx-1 cursor-pointer opacity-70 hover:opacity-100 transition-opacity duration-150 ease-linear"/>
                </a>

            </div>

            <!-- Mobile -->
            <div class="lg:hidden inline-block">
                <Button size="icon" variant="link" rounded="full" aria-label="Menu" id="menu">
                    <img src="/icons/menu.svg" alt="Menu" class="w-6 h-6 invert"/>
                </Button>
            </div>
        </div>
    </nav>

    <!-- Mobile -->
    <nav class="group-aria-expanded:flex hidden md:hidden mt-2 shadow-zinc-500/20 shadow-2xl border-zinc-800 border-t border-l bg-header-translucent flex-col gap-2 rounded-3xl backdrop-blur-md p-2 mx-auto w-10/12 md:w-3/4">
        <div class="size-full flex flex-col gap-y-2">
            <div class="py-2">
                {links.map((item) =>
                        <a href={item.href}
                           class="rounded-3xl px-4 py-3 leading-none flex justify-between transition-colors text-zinc-400 hover:bg-zinc-700/10 hover:text-white">
                            <span>{item.name}</span>
                            <img src="/icons/chevron-right.svg" alt="Chevron" class="w-4 h-4 invert"/>
                        </a>
                )}
            </div>
            <div class="mb-4 flex justify-center gap-x-4 sm:gap-x-8">
                <a href="https://x.com/VoxelioStudio" target="_blank" rel="noopener noreferrer">
                    <img src="/icons/company/x.svg" alt="x" class="w-6 h-6 invert mx-1 cursor-pointer opacity-70 hover:opacity-100 transition-opacity duration-150 ease-linear"/>
                </a>
                <a href="https://bsky.app/profile/voxelstudio.bsky.social" target="_blank" rel="noopener noreferrer">
                    <img src="/icons/company/bluesky.svg" alt="Bluesky" class="w-6 h-6 invert mx-1 cursor-pointer opacity-70 hover:opacity-100 transition-opacity duration-150 ease-linear"/>
                </a>
                <a href="https://discord.gg/TAmVFvkHep" target="_blank" rel="noopener noreferrer">
                    <img src="/icons/company/discord.svg" alt="Discord" class="w-6 h-6 invert mx-1 cursor-pointer opacity-70 hover:opacity-100 transition-opacity duration-150 ease-linear"/>
                </a>
            </div>
        </div>
    </nav>
</header>

<script is:inline define:vars={{transparent}}>
    const classList = document.getElementById('navbar').classList;
    const strings = ['border-t', 'border-l', 'bg-header-translucent', 'backdrop-blur-md'];
    if (transparent) {
        window.addEventListener('scroll', () => window.scrollY > 0 ? classList.add(...strings) : classList.remove(...strings));
    }

    const menu = document.getElementById('menu');
    const header = document.getElementById('header');
    menu.addEventListener('click', () => {
        header.setAttribute('aria-expanded', header.getAttribute('aria-expanded') === 'true' ? 'false' : 'true');
    });
</script>
